/* domino.js - a JS fast dashboard prototyping framework - Version: 1.2.2 - Author:  Alexis Jacomy, Linkfluence - License: MIT */
(function(V,i){function ba(){M.strict?v.apply(this,arguments):oa.apply(this,arguments)}function v(){var a="",i;for(i in arguments)a+=(a?" ":"")+arguments[i];throw Error(a);}function oa(){M.verbose&&fa.apply(this,arguments)}function fa(){var a=[],i;for(i in arguments)a.push(arguments[i]);M.displayTime&&a.unshift(("00000000"+((new Date).getTime()-pa)).substr(-8));console&&console.log instanceof Function&&console.log.apply(console,a)}var la=/^[a-zA-Z_$-][a-zA-Z_$0-9-]*$/,pa=new Date,W={};if(V.domino)throw Error("domino already exists");
V.domino=function(a,n){function f(b){var b=b||{},e={getEvents:G,getLabel:qa,expand:Q,warn:t,log:E,die:q,get:z};b.full?(e.kill=V,e.update=d,e.request=A,e.settings=y,e.addModule=c,e.getEvent=function(){B.getEvent.apply(B,arguments)},e.addEventListener=function(){B.addEventListener.apply(B,arguments)},e.removeEventListener=function(){B.removeEventListener.apply(B,arguments)},e.configuration=U,e.dispatchEvent=function(b,e){w({events:B.getEvent(b,e)});return this}):(b.request&&(Object.defineProperty(e,
"_services",{value:[]}),e.request=function(b,e){var a,j;if(l.check("string",b)){j={service:b};for(a in e||{})j[a]=e[a];this._services.push(j)}else if(l.check("object",b))this._services.push(b);else if(l.check("array",b))for(a in b)this._services.push(b[a]);return this}),b.dispatchEvent&&(Object.defineProperty(e,"_events",{value:[]}),e.dispatchEvent=function(b,e){this._events.push({type:b,data:e});return this}),b.update&&(Object.defineProperty(e,"_properties",{value:[]}),e.update=function(b,e){if("object"===
typeof b)for(var a in b)this._properties.push({property:a,value:b[a]});else"string"===typeof b&&1<arguments.length&&this._properties.push({property:b,value:e});return this}));return e}function o(b){b.request!==i&&(b.request=function(){q("This method is no longer available.");return this});b.dispatchEvent!==i&&(b.dispatchEvent=function(){q("This method is no longer available.");return this})}function g(b,e){var C,a,m=e||{};b===i&&q("Property name not specified");"string"!==l.get(b)&&q("The property name must be a string");
N[b]!==i&&q('Property "'+b+'" already exists');ca[b]!==i&&q('"'+b+'" can not be used to name a property');b.match(la)||q("Property name not valid ("+la+")");ga[b]={};for(a in m)ga[b][a]=m[a];ha[b]=m.label||b;m.type!==i&&(l.isValid(m.type)?O[b]=m.type:t('Property "'+b+'": Type not valid'));m.setter!==i&&("function"!==l.get(m.setter)?t('Property "'+b+'": Setter is not a function'):(H[b]=m.setter,ia[b]=!0));H[b]=H[b]||function(e){if(l.deepScalar(O[b])&&l.compare(e,N[b],O[b]))return!1;O[b]&&!l.check(O[b],
e)?t('Property "'+b+'": Wrong type error'):N[b]=e;return!0};m.getter!==i&&("function"!==l.get(m.getter)?t('Property "'+b+'": Getter is not a function'):(I[b]=m.getter,ja[b]=!0));I[b]=I[b]||function(){return N[b]};if(m.value!==i||O[b])m.value!==i?ma(b,m.value):E('Property "'+b+'": Initial value is missing');if(m.triggers!==i)for(C in!l.check("array|string",m.triggers)&&t('Property "'+b+'": Events ("triggers") must be specified in an array or separated by spaces in a string'),P[b]=u.array(m.triggers),
P[b]||[])R[P[b][C]]=R[P[b][C]]||[],R[P[b][C]].push(b);m.dispatch!==i&&(!l.check("array|string",m.dispatch)?t('Property "'+b+'": Events ("dispatch") must be specified in an array or separated by spaces in a string'):X[b]=u.array(m.dispatch));return B}function k(b){var e=b||{};(e.id===i||"string"!==l.get(e.id))&&q("The service id is not indicated.");l.check("function|string",e.url)||q("The service URL is not valid.");Y[e.id]!==i&&q('The service "'+e.id+'" already exists.');Y[e.id]=function(b){E('Calling service "'+
e.id+'".');var a=b||{},m=a.shortcuts||{},j={contentType:a.contentType||e.contentType,dataType:a.dataType||e.dataType,type:(a.type||e.type||"GET").toString().toUpperCase(),data:a.data!==i?a.data:"function"===l.get(e.data)?e.data.call(f(),a):e.data,url:"function"===l.get(e.url)?e.url.call(f(),a):e.url,error:function(b,C){B.dispatchEvent("domino.ajaxFailed");var d=a.error||e.error;E('Loading service "'+e.id+'" failed with message "'+b+'" and status '+C.status+".");"function"===l.get(d)&&D(d,{parameters:[b,
C,a],loop:a.loop||w,scope:{request:!0,dispatchEvent:!0,update:!0}})}},d,p,h;p=y("shortcutPrefix");var b=RegExp(p+"(\\w+)","g"),c=RegExp("^"+p+"(\\w+)$"),z=null,n;for("string"!==l.get(j.url)&&q('The URL is no more a string (typed "'+l.get(j.url)+'")');(n=j.url.match(b))&&j.url!==z;)for(d in z=j.url,n)p=Q(n[d].match(c)[1],m),j.url=j.url.replace(RegExp(n[d],"g"),p);d=!0;"string"===l.get(j.data)&&j.data.match(c)&&(j.data=Q(j.data.match(c)[1],m));if("object"===l.get(j.data))for(;d;)for(h in d=!1,j.data)"string"===
l.get(j.data[h])&&j.data[h].match(c)&&(j.data[h]=Q(j.data[h].match(c)[1],m),d=!0);j.success=function(b){var C,d,na,p,n={},z=[],g=[],q={},A=!1,k=a.path||e.path,g=a.setter||e.setter,r=a.success||e.success;p=a.expect||e.expect||y("expect");if("function"===l.get(p)&&!p.call(f(),b,a,e))E('"expect" test failed for service "'+e.id+'".'),j.error.call(this,"Unexpected data received.",this.xhr());else{E('Service "'+e.id+'" successfull.');"string"===l.get(g)&&g.match(c)&&(g=Q(g.match(c)[1],m));"string"===l.get(k)&&
k.match(c)&&(k=Q(k.match(c)[1],m));p=b;(k||"").match(/^(?:\w+\.)*\w+$/)?d=l.get(k,"string")?k.split("."):i:"string"===l.get(k)&&t('Path "'+k+'" does not match RegExp /^(?:\\w+\\.)*\\w+$/');if(d)for(C in d)p=p[d[C]],p===i&&t('Wrong path "'+k+'" for service "'+e.id+'".');d=u.array(e.events);for(C in d)n[d[C]]=1,A=!0;d=u.array(a.events);for(C in d)n[d[C]]=1,A=!0;g&&H[g]&&p!==i&&(q[g]=p,A=!0);if("function"===l.get(r)){b=D(r,{parameters:[b,a],scope:{request:!0,dispatchEvent:!0,update:!0}});d=u.array(b.events);
for(h in d)A=!0,n[d[h].type]=1;for(h in b.update)q[h]===i?(q[h]=b.update[h],A=!0):t('The key "'+h+'" is nor a method neither a property.');if((b.services||[]).length)A=!0,z=z.concat(b.services);o(b)}g=[];for(na in n)g.push(B.getEvent(na));A&&(a.loop||w)({events:g,update:q,services:z})}};d=a.before||e.before;null!=d&&"function"===l.get(d)&&D(d,{parameters:[a],loop:!0,scope:{dispatchEvent:!0,update:!0}});a.abort&&da[e.id]&&da[e.id].abort();da[e.id]=u.ajax(j)};return B}function c(b,e){var a,d={},m={},
j,c,p;b===i&&q("Module class not specified.");"function"!==l.get(b)&&q("First parameter must be a function.");b.apply(d,(e||[]).concat(f()));j=d.triggers||{};for(p in j.events||{})S[p]=S[p]||[],S[p].push(j.events[p]);for(c in j.properties||{}){for(a in X[c]||[])T[c]=T[c]||[],T[c].push(j.properties[c]);I[c]!==i&&(z(c),D(j.properties[c],{parameters:[f()]}))}for(p in R||{})m[p]=1;for(p in J||{})m[p]=1;for(p in L||{})m[p]=1;for(p in m)d.addEventListener(p,h);Z.push(d);return d}function d(b,e){var a="object"===
typeof b&&1===arguments.length?b||{}:{};"string"===typeof b&&(a[b]=e);w({update:a});return this}function h(b){w({events:[b],emitter:b.target})}function w(b){var e,a,d,m,j,c,h,g=!1,n=[],z=[],l=[],b=b||{},k={},r={};b.loop=(+b.loop||0)+1;b.loopId=b.loopId||++ba;y("maxDepth")&&b.loop>y("maxDepth")&&q("Loop "+b.loopId+" exceeds maximum depth ("+y("maxDepth")+")");var s=u.array(b.events);h=u.array(b.services);var v=b.update||{};if(y("verbose")){E("Iteration "+b.loop+" (loop "+b.loopId+")");if(s.length){j=
[];for(a in s)j.push(s[a].type);E(" -> Events: ",j)}if(h.length){j=[];for(a in h)j.push("string"===typeof h[a]?h[a]:h[a].service);E(" -> Services: ",j)}j=[];for(a in v)j.push(a);j.length&&E(" -> Update: ",j)}for(e in v)if(H[e]===i)t('The property "'+e+'" is not referenced.');else if(j=ma(e,v[e])||!!b.force){for(a in T[e])D(T[e][a],{parameters:[f(),{property:e,emitter:b.emitter}]});for(a in X[e]||[])j=X[e][a],k[j]=B.getEvent(j)}if(h.length)if(y("mergeRequests"))A(h);else for(d in h)A(h[d]);for(a in s){c=
s[a];for(d in h=c.data||{},e=R[c.type]||[],e)h[e[d]]!==i&&(g=!0,r[e[d]]=h[e[d]]);for(m in S[c.type])D(S[c.type][m],{parameters:[f(),c,b.emitter]});for(d in J[c.type]||[])if(0>n.indexOf(J[c.type][d])){n.push(J[c.type][d]);h=D(J[c.type][d],{parameters:[c],scope:{request:!0,dispatchEvent:!0,update:!0}});e=u.array(h.events);for(m in e)k[e[m].type]=e[m];for(m in h.update)r[m]===i?(g=!0,r[m]=h.update[m]):t('The property "'+m+'" has already been updated in the current loop.');if((h.services||[]).length)g=
!0,l=l.concat(h.services);o(h)}for(d in L[c.type]||[])j=L[c.type][d],k[j]=B.getEvent(j)}for(c in k)B.dispatchEvent(c,k[c].data),z.push(k[c]),g=!0;g&&w({events:z,update:r,services:l,emitter:b.emitter,loopId:b.loopId,loop:b.loop})}function z(b){if(I[b]){if(ja[b]){for(var a=[],d={},c=1,h=arguments.length;c<h;c++)a.push(arguments[c]);d[b]=N[b];a=D(I[b],{parameters:a,inputValues:d});return K(b)?u.clone(a.returned):a.returned}return K(b)?u.clone(I[b]()):I[b]()}t('Property "'+b+'" not referenced.')}function ma(b,
a){if(H[b]){if(ia[b]){var d,c;d=[];c={};K(b)&&(a=u.clone(a));c[b]=z(b);for(var h=1,j=arguments.length;h<j;h++)d.push(arguments[h]);c=D(H[b],{parameters:d,inputValues:c});(d="boolean"!==l.get(c.returned)||c.returned)&&(N[b]=c.update[b]);return d}return H[b].call(f(),K(b)?u.clone(a):a)}t('Property "'+b+'" not referenced.');return!1}function A(b,a){if(l.check("string",b))if(Y[b])Y[b](a);else t('Service "'+b+'" not referenced.');else if(l.check("object",b))A(b.service,b);else if(l.check("array",b)){var a=
a||{},d,c=b.length;if(a.merge!==i?a.merge:y("mergeRequests")){var h,j,g=c,n=[];for(d=0;d<c;d++){if("string"===typeof b[d])h={service:b[d]};else for(j in h={},b[d])h[j]=b[d][j];(function(b){h.loop=function(a){n[b]=a;if(!--g){var d,e,h={update:{},events:[],services:[]};for(d=0;d<c;d++){a=n[d]||{};for(e in a.update||{})h.update[e]=a.update[e];h.events=h.events.concat(a.events||[]);h.services=h.services.concat(a.services||[])}w(h)}}})(d);A(h)}}else for(d=0,c=b.length;d<c;d++)A(b[d])}return this}function D(b,
a){var d,c,h={},j=a||{},g=f(j.scope);"function"!==l.get(b)&&q("The first parameter must be a function");for(d in j.inputValues||{})g[d]=j.inputValues[d];c={returned:b.apply(g,j.parameters||[]),update:{},events:[],services:[]};null!=g._events&&!l.check("array",g._events)?t("Events must be stored in an array."):c.events=g._events;for(d in g)h[d]=g[d];for(d in g._properties)h[g._properties[d].property]=g._properties[d].value;for(d in h)H[d]!==i?c.update[d]=h[d]:ca[d]===i&&t('The key "'+d+'" is not a method nor a property.');
for(d in j.inputValues)c.update[d]=g[d];for(d in g._services)c.services[d]=g._services[d];if(j.loop){h=(c.services||[]).length||(c.events||[]).length;if(!h)for(d in c.update)h=!0;h&&(l.check("function",j.loop)?j.loop:w)(c)}else return c}function qa(b){return ha[b]}function G(b){return P[b]}function Q(b){var a=b,d=(b||"").toString().match(RegExp("^"+y("shortcutPrefix")+"(\\w+)$"));d&&d.length&&(t("Prefix in expand() calls is deprecated."),a=d[1]);for(var d=1,c=arguments.length;d<c;d++)if((arguments[d]||
{})[a]!==i)return arguments[d][a];if("function"===l.get(I[a]))return z(a);if("function"===l.get($[a]))return $[a].call(f());t('The shortcut "',a,'" has not been recognized.');return a}function K(b){b=(ga[b]||{}).clone;return b!==i?!!b:y("clone")}function U(b){return arguments.length?u.clone(ka[b]):u.clone(ka)}function V(){var b;E('Killing instance "'+F+'"');for(b in Z)Z[b].removeEventListener();$=da=Y=L=J=T=S=X=R=Z=ia=ja=N=H=I=P=ha=O=Z=null;for(b in aa)delete aa[b];W[F]&&delete W[F]}function y(b,
a){if("string"===typeof b&&1===arguments.length)return ea[b]!==i?ea[b]:M[b];var d="object"===typeof b&&1===arguments.length?b||{}:{};"string"===typeof b&&(d[b]=a);for(var c in d)d[c]!==i?ea[c]=d[c]:delete ea[c];return this}function t(){var b=["["+(F||"domino")+"]"];y("strict")||b.push("WARNING");for(var a in arguments)b.push(arguments[a]);y("strict")?v.apply(this,b):y("verbose")&&fa.apply(this,b)}function q(){var b=["["+(F||"domino")+"]"],a;for(a in arguments)b.push(arguments[a]);v.apply(this,b)}
function E(){var b=["["+(F||"domino")+"]"];if(y("verbose")){for(var a in arguments)b.push(arguments[a]);fa.apply(this,b)}}(function(){x.call(this);for(var b in x.prototype)this[b]=x.prototype[b]}).call(this);var B=this,u=s.utils,l=s.struct,ea={},aa,ka,O={},ha={},P={},I={},H={},N={},ga={},ja={},ia={},Z=[],ba=0,R={},X={},S={},T={},J={},L={},Y={},da={},$={},ca={events:1,services:1,hacks:1};(function(){for(var b in Object.prototype)ca[b]=1;for(b in f({full:!0}))ca[b]=1})();aa=f({full:!0});var r={},F;
"string"===l.get(a)?(r=n,r.name=a):a!==i&&"object"===l.get(a)?r=a:n!==i&&"object"===l.get(n)&&(r=n);r.name=F||r.name;(F=r.name)&&(W[F]?q('An instance named "'+F+'" is already running.'):W[F]=aa);(function(){for(var b in r.properties||[])g(r.properties[b].id,r.properties[b]);for(b in r.hacks||[]){var a=void 0,d=void 0,c=r.hacks[b]||{};c.triggers===i&&q("A hack requires at least one trigger to be bound");a=u.array(c.triggers);for(d in a)L[a[d]]=L[a[d]]||[],J[a[d]]=J[a[d]]||[],c.method&&J[a[d]].push(c.method),
c.dispatch&&(L[a[d]]=L[a[d]].concat(u.array(c.dispatch)))}for(b in r.services||[])k(r.services[b]);for(b in r.shortcuts||[])a=r.shortcuts[b].id,d=r.shortcuts[b].method,a===i&&q("Shortcut ID not specified."),$[a]&&q('Shortcut "'+a+'" already exists.'),d===i&&q("Shortcut method not specified."),$[a]=d})();ka=u.clone(r);return aa};var s=V.domino;s.utils={array:function(a,i){var f="string"===s.struct.get(a)?a.split(i||" "):"array"===s.struct.get(a)?a:[a],o=[],g;for(g in f)f[g]&&o.push(f[g]);return o},
clone:function(a){if(!a)return a;var i,f;if("array"===K.get(a))for(f in i=[],a)i[f]=this.clone(a[f]);else if("date"===K.get(a))i=new Date(a.getTime());else if("object"===K.get(a))if(a.prototype)i=a;else{i={};for(var o in a)i[o]=this.clone(a[o])}else i=a;return i},ajax:function(a,i){"string"===typeof a?a={url:a,ok:i}:"object"!==K.get(a)&&v("[domino.global] Invalid parameter given to AJAX");var f=a.type||"GET",o=a.url||"",g=a.contentType||"application/x-www-form-urlencoded",k=a.dataType||"json",c=new XMLHttpRequest,
d,h,w;if(a.data){if("string"===typeof a.data)h=a.data;else if(/json/.test(g))h=JSON.stringify(a.data);else{h=[];for(w in a.data)h.push(encodeURIComponent(w)+"="+encodeURIComponent(a.data[w]));h=h.join("&")}/GET|DEL/i.test(f)&&(o+=/\?/.test(o)?"&"+h:"?"+h,h="")}c.onreadystatechange=function(){if(4==c.readyState)if(d&&clearTimeout(d),/^2/.test(c.status)){h=c.responseText;if(/json/.test(k))try{h=JSON.parse(c.responseText)}catch(g){return a.error&&a.error("JSON parse error: "+g.message,c)}a.success&&
a.success(h,c)}else{var i=+c.status?c.responseText:c.responseText.length?"Aborted: "+c.responseText:"Aborted";a.error&&a.error(i,c)}};c.open(f,o,!0);c.setRequestHeader("Content-Type",g);if(a.headers)for(w in a.headers)c.setRequestHeader(w,a.headers[w]);a.timeout&&(d=setTimeout(function(){c.onreadystatechange=function(){};c.abort();a.error&&a.error&&a.error("timeout",c)},1E3*a.timeout));c.send(h);return c}};s.struct=function(){var a=["number","string","boolean","null","undefined"],n="Boolean,Number,String,Function,Array,Date,RegExp,Object".split(","),
f={},o=["*"],g={},k;for(k in n){var c=n[k];o.push(c.toLowerCase());f["[object "+c+"]"]=c.toLowerCase()}return{add:function(a,c,w){var f,n,k,D,x,G;1===arguments.length?"object"===this.get(a)?(G=a,k=G.id,x=G.struct):v("[domino.global] If struct.add is called with one arguments, it has to be an object"):2===arguments.length?("string"!==this.get(a)||!a?v("[domino.global] If struct.add is called with more than one arguments, the first one must be the string id"):k=a,x=c):v("[domino.global] struct.add has to be called with one or three arguments");
("string"!==this.get(k)||0===k.length)&&v("[domino.global] A structure requires an string id");g[k]!==i&&"proto"!==g[k]&&v('[domino.global] The structure "'+k+'" already exists');g[k]=1;n=s.utils.array((G||{}).proto);D={};for(f in n)g[n[f]]===i&&(g[n[f]]=1,D[n[f]]=1);"function"!==this.get(x)&&!this.isValid(x)&&v('[domino.global] A structure requires a valid "structure" property describing the structure. It can be a valid structure or a function that test if an object matches the structure.');~o.indexOf(k)&&
v('[domino.global] "'+k+'" is a reserved structure name');g[k]=G===i?{id:k,struct:x}:{};if(G!==i)for(f in G)g[k][f]=G[f];for(f in D)f!==k&&delete g[f]},get:function(a){return null==a?""+a:f[Object.prototype.toString.call(a)]||"object"},check:function(a,c){var f,k,n=this.get(c);if("string"===this.get(a)){f=a.replace(/^\?/,"").split(/\|/);for(k in f)if(0>o.indexOf(f[k])&&g[f[k]]===i)return ba("[domino.global] Invalid type"),!1;if(null==c)return!!a.match(/^\?/,"");a.replace(/^\?/,"");for(k in f)if(g[f[k]]&&
("function"===this.get(g[f[k]].struct)&&!0===g[f[k]].struct(c)||this.check(g[f[k]].struct,c)))return!0;return!(!~f.indexOf("*")&&!~f.indexOf(n))}if("object"===this.get(a)){if("object"!==n)return!1;for(f in a)if(!this.check(a[f],c[f]))return!1;for(f in c)if(a[f]===i)return!1;return!0}if("array"===this.get(a)){if("array"!==n)return!1;if(1!==a.length)return ba("[domino.global] Invalid type"),!1;for(f in c)if(!this.check(a[0],c[f]))return!1;return!0}return!1},deepScalar:function(d){var c;if("string"===
this.get(d)){d=d.replace(/^\?/,"").split(/\|/);for(c in d)if(0>a.indexOf(d[c]))return!1;return!0}if(this.check("object|array",d)){for(c in d)if(!this.deepScalar(d[c]))return!1;return!0}return!1},compare:function(a,c,f){this.get(a);this.get(c);var g;if(!this.deepScalar(f)||!this.check(f,a)||!this.check(f,c))return!1;if("string"===this.get(f))return a===c;if("object"===this.get(f)){for(g in f)if(!this.compare(a[g],c[g],f[g]))return!1;return!0}if("array"===this.get(f)){if(a.length!==c.length)return!1;
var i=a.length;for(g=0;g<i;g++)if(!this.compare(a[g],c[g],f[0]))return!1;return!0}return!1},isValid:function(a){var c,f;if("string"===this.get(a)){a=a.replace(/^\?/,"").split(/\|/);for(f in a)if(0>o.indexOf(a[f])&&g[a[f]]===i)return!1;return!0}if("object"===this.get(a)){for(c in a)if(!this.isValid(a[c]))return!1;return!0}return"array"===this.get(a)?1===a.length?this.isValid(a[0]):!1:!1}}}();var U=s.utils,K=s.struct,M={maxDepth:0,strict:!1,verbose:!1,displayTime:!1,shortcutPrefix:":",mergeRequests:!0,
clone:!1};s.settings=function(a,n){if("string"===typeof a&&1===arguments.length)return M[a];var f="object"===typeof a&&1===arguments.length?a||{}:{};"string"===typeof a&&(f[a]=n);for(var o in f)f[o]!==i?M[o]=f[o]:delete M[o];return this};s.instances=function(a){if(arguments.length)return W[a];v("[domino.global] You need to indicate a name to get the instance.")};s.EventDispatcher=function(){Object.defineProperty(this,"_handlers",{value:{}})};var x=s.EventDispatcher;x.prototype.addEventListener=function(a,
i){if(arguments.length)if(1===arguments.length&&"object"===U.type.get(arguments[0]))for(a in arguments[0])this.addEventListener(a,arguments[0][a]);else if(1<arguments.length){var f,a=arguments[0],i=arguments[1],o=U.array(a),g;for(g in o)f=o[g],this._handlers[f]||(this._handlers[f]=[]),this._handlers[f].push({handler:i})}return this};x.prototype.removeEventListener=function(a,i){var f,o,g,k,c=U.array(a);if(!arguments.length){for(f in this._handlers)delete this._handlers[f];return this}if(i)for(f in c){k=
c[f];if(this._handlers[k]){g=[];for(o in this._handlers[k])this._handlers[k][o].handler!==i&&g.push(this._handlers[k][o]);this._handlers[k]=g}this._handlers[k]&&0===this._handlers[k].length&&delete this._handlers[k]}else for(f in c)delete this._handlers[c[f]];return this};x.prototype.dispatchEvent=function(a,n){var f,o,g,k,c,d=U.array(a),n=n===i?{}:n;for(f in d)if(c=d[f],this._handlers[c]){k=this.getEvent(c,n);g=[];for(o in this._handlers[c])this._handlers[c][o].handler(k),this._handlers[c][o].one||
g.push(this._handlers[c][o]);this._handlers[c]=g}return this};x.prototype.getEvent=function(a,i){return{type:a,data:i||{},target:this}};s.module=function(){x.call(this);for(var a in x.prototype)this[a]=x.prototype[a];this.triggers={properties:{},events:{}}}})(window);
